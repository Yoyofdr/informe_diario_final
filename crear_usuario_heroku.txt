from django.contrib.auth.models import User
from alerts.models import Organizacion, Destinatario

email = "rfernandezdelrio@uc.cl"
if not User.objects.filter(email=email).exists():
    user = User.objects.create_user(email, email, 'Test123\!')
    user.first_name = "Rodrigo"
    user.last_name = "Fernandez"
    user.save()
    print("Usuario creado")
else:
    user = User.objects.get(email=email)
    print("Usuario ya existe")

org, created = Organizacion.objects.get_or_create(
    dominio="uc.cl",
    defaults={'nombre': 'UC', 'admin': user}
)
print(f"Org: {org.nombre}")

dest, created = Destinatario.objects.get_or_create(
    email=email,
    defaults={'nombre': 'Rodrigo Fernandez', 'organizacion': org}
)
print(f"Destinatario: {dest.email}")
print(f"Total destinatarios: {Destinatario.objects.count()}")
